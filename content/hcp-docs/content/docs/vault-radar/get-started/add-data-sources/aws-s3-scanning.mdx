---
page_title: Scan AWS S3 with Radar Agent
description: >-
  Scan AWS S3 buckets with on-prem Radar Agent for dumped secrets.
# START AUTO GENERATED METADATA, DO NOT EDIT
created_at: 2025-11-20T10:11:09+05:30
last_modified: 2025-11-21T13:53:23-05:00
# END AUTO GENERATED METADATA
---

# Scan AWS S3 with Radar Agent

@include 'beta-feature.mdx'

HCP Vault Radar allows users to scan AWS S3 buckets for application data,
configuration files, backups, and other sensitive information.

Vault Radar supports versioned buckets, allowing you to scan the previous
versions of objects.

## Connect AWS S3

Scanning AWS S3 buckets requires the [HCP Vault Radar
agent](/hcp/docs/vault-radar/agent/deploy). Once you deploy the agent,
you can add AWS S3 as a data source.

## Prerequisites

You need one of the following AWS authentication methods:

- HCP Vault Radar agent version 0.38.0 or later
- IAM role authentication with an EC2 instance or configured IAM role
- Environment variables authentication with AWS Access Key ID and Secret Access Key

<Warning>

HCP Vault Radar does not support short lived AWS credentials through environment
variables (`AWS_SESSION_TOKEN`).

</Warning>

Both authentication methods support an optional assume role ARN for
cross-account access or elevated permissions. For more information about
assuming roles, refer to the [AWS STS AssumeRole
documentation](https://docs.aws.amazon.com/STS/latest/APIReference/API_AssumeRole.html).

### Required permissions

The IAM user, role, or assumed role must have the following permissions:

| Service            | Permission                      | Documentation                                                                             |
|--------------------|---------------------------------|-------------------------------------------------------------------------------------------------------------------------|
| STS                | `sts:GetCallerIdentity`         | [GetCallerIdentity API](https://docs.aws.amazon.com/STS/latest/APIReference/API_GetCallerIdentity.html) |
| S3                 | `s3:ListAllMyBuckets`           | [ListBuckets API](https://docs.aws.amazon.com/AmazonS3/latest/API/API_ListBuckets.html) |
| S3                 | `s3:ListBucket`                 | [ListObjectsV2 API](https://docs.aws.amazon.com/AmazonS3/latest/API/API_ListObjectsV2.html) |
| S3                 | `s3:GetObject`                  | [GetObject API](https://docs.aws.amazon.com/AmazonS3/latest/API/API_GetObject.html) |
| Account (optional) | `account:GetAccountInformation` | [GetAccountInformation API](https://docs.aws.amazon.com/accounts/latest/reference/API_GetAccountInformation.html) |

The `account:GetAccountInformation` permission is optional. Scans without this
permission will not include the AWS account name on the UI for data source
metadata.

**Example IAM policies:**

AWS lets you define IAM policies at a high level as well as very granular levels.

<Tabs>
<Tab heading="Allow scanning all buckets">

```json
{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Effect": "Allow",
            "Action": [
                "sts:GetCallerIdentity"
            ],
            "Resource": "*"
        },
        {
            "Effect": "Allow",
            "Action": [
                "s3:ListAllMyBuckets",
                "s3:ListBucket"
            ],
            "Resource": "arn:aws:s3:::*"
        },
        {
            "Effect": "Allow",
            "Action": "s3:GetObject",
            "Resource": "arn:aws:s3:::*/*"
        },
        {
            "Effect": "Allow",
            "Action": [
                "account:GetAccountInformation"
            ],
            "Resource": "*"
        }
    ]
}
```

</Tab>
<Tab heading="Allow scanning selected buckets only">

```json
{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Effect": "Allow",
            "Action": [
                "sts:GetCallerIdentity",
                "account:GetAccountInformation"
            ],
            "Resource": "*"
        },
        {
            "Effect": "Allow",
            "Action": "s3:ListAllMyBuckets",
            "Resource": [
                "arn:aws:s3:::*",
            ]
        },
        {
            "Effect": "Allow",
            "Action": "s3:ListBucket",
            "Resource": [
                "arn:aws:s3:::my-app-logs",
                "arn:aws:s3:::my-app-data",
                "arn:aws:s3:::my-app-backups"
            ]
        },
        {
            "Effect": "Allow",
            "Action": "s3:GetObject",
            "Resource": [
                "arn:aws:s3:::my-app-logs/*",
                "arn:aws:s3:::my-app-data/*",
                "arn:aws:s3:::my-app-backups/*"
            ]
        }
    ]
}
```

</Tab>
</Tabs>

## Configure the agent for AWS S3 scanning

Set up and manage AWS S3 agent scan from the Vault Radar module in the [HCP
Portal](https://portal.cloud.hashicorp.com/). 

1. Click **Settings**.

1. Click **Data Sources**.

1. Select **Vault Radar Agent Scan**.

1. Select **AWS S3** in the **Object Storage** section.
   ![Scan a New Data Source](/img/docs/vault-radar/agent/aws-s3/select-s3-data-source.png)

1. Select an AWS authentication method from the **Authentication method** pulldown menu.

1. Enter the details for the selected method.

   <Tabs>
   <Tab heading="IAM Role">
   
   - Select **IAM Role** if you want to use instance profile or role-based authentication.
   
   ![IAM Role](/img/docs/vault-radar/indexing/aws-secrets-manager/iam-role.png)
   
   - (Optional) Enter an assume role ARN in the **Assume Role ARN** text field if you need to assume a different role for access.
   
   </Tab>
   <Tab heading="Environment Variables">
   
   - Select **AWS Credentials from environment variables** if you want to use access keys.
   
   ![Environment Variables](/img/docs/vault-radar/indexing/aws-secrets-manager/environment-variables.png)
   
   - Enter your AWS Access Key ID location in the **AWS Access Key ID Env variable** text field (default: `env://AWS_ACCESS_KEY_ID`).
   
   - Enter your AWS Secret Access Key location in the **AWS Secret Access Key Env variable** text field (default: `env://AWS_SECRET_ACCESS_KEY`).
   
   - (Optional) Enter an assume role ARN in the **Assume Role ARN** text field if you need to assume a different role for access.
   
   </Tab>
   </Tabs>

1. Click **Next** to validate and establish the connection.

1. Choose the buckets to monitor. You can either choose all buckets, or individual buckets.
   ![Select Buckets](/img/docs/vault-radar/agent/aws-s3/select-buckets.png)

   <Note>
    
   Vault Radar skips buckets that do not have the `s3:GetObject` policy granted,
   even if you've chosen it from the list here.
    
   </Note>

1. Click **Finish**.

1. Vault Radar scans all the objects in the selected buckets and reports the results.
   ![Secrets Overview](/img/docs/vault-radar/agent/aws-s3/secrets-overview.png)
