---
page_title: Correlate findings with Vault Enterprise
description: >-
  Correlate findings from HCP Vault Radar with secrets stored in HCP Vault Dedicated or Vault Enterprise.
# START AUTO GENERATED METADATA, DO NOT EDIT
created_at: 2025-09-05T13:57:53-05:00
last_modified: 2025-10-22T14:57:55-04:00
# END AUTO GENERATED METADATA
---

# Correlate findings with Vault

<Highlight title="Vault Enterprise Only">

Correlation between HCP Vault Radar and HashiCorp Vault is supported on HCP
Vault Dedicated or Vault Enterprise clusters.

</Highlight>

When the Vault Radar agent connects to a Vault Dedicated or Vault Enterprise cluster, 
Vault Radar can correlate findings with secrets stored in Vault. This allows you to identify 
what secrets you need to rotate.

## Connect a Vault cluster

Before you can correlate findings with Vault, you need to [deploy the Radar
agent](/hcp/docs/vault-radar/agent/deploy). Once you deploy the agent, you can
configure and connect Vault to the agent.

## Prerequisites

You need one of the following Vault authentication methods:

- Kubernetes
- AppRole
- Token

The authentication methods require a policy that allows the Vault Radar agent to
read all KV secrets from Vault.

### Create a Vault policy

Vault Radar requires the following capabilities:
- Validate tokens (using self-lookup API)
- List and read all namespaces
- List all auth methods and mounts in each namespace
- List all secrets in a KV secrets engine mount
- Read all the versions of a secret in a KV secret engine mount

A policy granting just the required level of access requires explicitly specifying the namespaces and KV mounts.

```hcl
path "auth/token/lookup-self" {
    capabilities = ["read"]
}

path "sys/license/status" {
    capabilities = ["read"]
}

# Assumption: Namespaces are atmost 2 levels deep
path "sys/namespaces/*" {
    capabilities = ["read", "list"]
}

path "+/sys/namespaces/*" {
    capabilities = ["read", "list"]
}

path "+/+/sys/namespaces/*" {
    capabilities = ["read", "list"]
}

path "sys/auth" {
    capabilities = ["read"]
}

path "+/sys/auth" {
    capabilities = ["read"]
}

path "+/+/sys/auth" {
    capabilities = ["read"]
}

path "sys/mounts" {
    capabilities = ["read"]
}

path "+/sys/mounts" {
    capabilities = ["read"]
}

path "+/+/sys/mounts" {
    capabilities = ["read"]
}

# Assumption: KV secret engine mounts are atmost 2 levels deep
path "+/metadata/*" {
    capabilities = ["read", "list"]
}

path "+/+/metadata/*" {
    capabilities = ["read", "list"]
}

path "+/+/+/metadata/*" {
    capabilities = ["read", "list"]
}

path "+/+/+/+/metadata/*" {
    capabilities = ["read", "list"]
}

path "+/data/*" {
    capabilities = ["read"]
}

path "+/+/data/*" {
    capabilities = ["read"]
}

path "+/+/+/data/*" {
    capabilities = ["read"]
}

path "+/+/+/+/data/*" {
    capabilities = ["read"]
}
```

For less restrictive environments, you can give broader permissions to Vault
Radar.

A simple policy that grants Vault Radar broad access to your Vault cluster.

```hcl
path "*" {
    capabilities = ["read", "list"]
}
```

### Agent configuration with Vault

Set up and manage a Vault cluster from the Vault Radar module in the [HCP Portal](https://portal.cloud.hashicorp.com/). Select **Settings**, then **Secret Managers**, and then click **Connect new secret manager**.
![Select a index source to scan](/img/docs/vault-radar/agent/agent-index-source-selection.png)

1. Select Vault and the Vault deployment type
1. Provide you Vault cluster URL
1. Select auth method and fill in details on the form, and select Next to validate the connection.

<Tabs>
<Tab heading="Kubernetes">

@include 'vault-radar/indexing/kubernetes-auth.mdx'

</Tab>
<Tab heading="App Role (push)">

@include 'vault-radar/indexing/app-role-auth.mdx'

</Tab>
<Tab heading="Token">

@include 'vault-radar/indexing/token-auth.mdx'

</Tab>
</Tabs>
