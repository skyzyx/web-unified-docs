---
layout: docs
page_title: Create a service account library
description: >-
  Create a library of LDAP service accounts that users and machines can check-out
  as needed.
# START AUTO GENERATED METADATA, DO NOT EDIT
created_at: 2025-11-24T10:37:31-08:00
last_modified: 2025-11-24T10:37:31-08:00
# END AUTO GENERATED METADATA
---

# Create a service account library

Create a library of service accounts that users and machines can check out as
needed. Vault automatically rotates the account password when clients return the
service account to the library.


## Before you start 

- **Check your Vault permissions**. You must have permission to enable and
  configure plugins in Vault.
- **You must have an LDAP plugin configured for OpenLDAP or Active Directory**.
  If you do not already have an LDAP plugin enabled, follow the
  [setup guide](/vault/docs/secrets/ldap/setup).
- **Create the library accounts on your LDAP server**. We highly recommend
  creating a dedicated accounts for the library. 


## Step 1: Create a library configuration file

For easier maintenance and reuse, create a JSON file `library.json`, with the
credential library configuration details.

```json
{
  "service_account_names":         "<list_of_LDAP_accounts>",
  "ttl":                           "<default_checkout_period>",
  "max_ttl":                       "<max_allowed_checkout_period>",
  "disable_check_in_enforcement":  "false"
}
```

For example:

```json
{
  "service_account_names":         "fizz@example.com,buzz@example.com",
  "ttl":                           "10h",
  "max_ttl":                       "24h",
  "disable_check_in_enforcement":  "false"
}
```

the following configuration file:

- defines the set of accounts in the library as `fizz@example.com` and `buzz@example.com`
- sets a default checkout time of 10 hours
- disallows renewals after 24 hours
- requires that the same Vault entity or client token checking out a service
  account also be the one to check the account back into the library.

<Tip>

  If your workflow uses a clean up process such that the client returning the
  service account regularly uses a different token than the client checking the
  account out, set `disable_check_in_enforcement=true`.

</Tip>



## Step 2: Configure the plugin

Apply the libray configuration file to your plugin.

<Tabs>

<Tab heading="CLI" group="cli">

@include 'ldap/create-library/cli.mdx'

</Tab>

<Tab heading="API" group="api">

@include 'ldap/create-library/api.mdx'

</Tab>

</Tabs>



## Step 3: Verify the service account settings

To verify the library settings, view the set status.

<Tabs>

<Tab heading="CLI" group="cli">

@include 'ldap/view-library/cli.mdx'

</Tab>

<Tab heading="API" group="api">

@include 'ldap/view-library/api.mdx'

</Tab>

</Tabs>



## Step 3: Test the check-out process 

To test the connection between Vault and your LDAP server, try checking out
and returning a service account.


<Tabs>

<Tab heading="CLI" group="cli">

@include 'ldap/account-checkout/cli.mdx'

@include 'ldap/account-checkin/cli.mdx'

</Tab>

<Tab heading="API" group="api">

@include 'ldap/account-checkout/api.mdx'

@include 'ldap/account-checkin/api.mdx'

</Tab>

</Tabs>